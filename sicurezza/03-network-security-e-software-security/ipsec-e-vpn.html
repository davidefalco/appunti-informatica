<!doctype html><html><head><title>IPsec e VPN</title><base href="../"><meta id="root-path" root-path="../"><link rel="icon" sizes="96x96" href="https://publish-01.obsidian.md/access/f786db9fac45774fa4f0d8112e232d67/favicon-96x96.png"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,minimum-scale=1,maximum-scale=5"><meta charset="UTF-8"><link rel="stylesheet" href="lib/styles/obsidian-styles.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="stylesheet" href="lib/styles/plugin-styles.css"><link rel="stylesheet" href="lib/styles/snippets.css"><link rel="stylesheet" href="lib/styles/generated-styles.css"><style></style><script type="module" src="lib/scripts/graph_view.js"></script><script src="lib/scripts/graph_wasm.js"></script><script src="lib/scripts/tinycolor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lib/scripts/webpage.js"></script><script src="lib/scripts/generated.js"></script></head><body class="theme-dark show-inline-title loading"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Sicurezza</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">00 Cifrari simmetrici</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="00-cifrari-simmetrici/cifrari-aperti.html"><span class="tree-item-title">Cifrari aperti</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="00-cifrari-simmetrici/cifrario-start-point.html"><span class="tree-item-title">Cifrario - Start point</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="00-cifrari-simmetrici/cifrario-di-cesare.html"><span class="tree-item-title">Cifrario di Cesare</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="00-cifrari-simmetrici/cifrario-di-playfair.html"><span class="tree-item-title">Cifrario di Playfair</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="00-cifrari-simmetrici/cifrario-di-vernam.html"><span class="tree-item-title">Cifrario di Vernam</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="00-cifrari-simmetrici/cifrario-di-vigenère.html"><span class="tree-item-title">Cifrario di Vigenère</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="00-cifrari-simmetrici/one-time-pad.html"><span class="tree-item-title">One-time pad</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="00-cifrari-simmetrici/sostituzione-a-permutazione.html"><span class="tree-item-title">Sostituzione a permutazione</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">01 DES e AES</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/aes.html"><span class="tree-item-title">AES</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/cifrari-a-blocchi.html"><span class="tree-item-title">Cifrari a blocchi</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/cifrari-a-flusso.html"><span class="tree-item-title">Cifrari a flusso</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/cifrari-a-flusso-e-cifrari-a-blocchi-start-point.html"><span class="tree-item-title">Cifrari a flusso e cifrari a blocchi - Start point</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/cifrario-di-feistel.html"><span class="tree-item-title">Cifrario di Feistel</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/des.html"><span class="tree-item-title">DES</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/esempio-di-des.html"><span class="tree-item-title">Esempio di DES</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/matematica-astratta.html"><span class="tree-item-title">Matematica astratta</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/operazioni-sui-cifrari-a-blocchi.html"><span class="tree-item-title">Operazioni sui cifrari a blocchi</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="01-des-e-aes/singolo-passo-di-des-nel-dettaglio.html"><span class="tree-item-title">Singolo passo di DES nel dettaglio</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">02 Cifrari asimmetrici</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/autenticazione-e-firma-elettronica.html"><span class="tree-item-title">Autenticazione e firma elettronica</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/funzioni-di-hash.html"><span class="tree-item-title">Funzioni di hash</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/introduzione-start-point.html"><span class="tree-item-title">Introduzione - Start point</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/primo-requisito-diffie-hellman.html"><span class="tree-item-title">Primo requisito Diffie-Hellman</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/principi-dei-sistemi-crittografici-a-chiave-pubblica.html"><span class="tree-item-title">Principi dei sistemi crittografici a chiave pubblica</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/scambio-di-chiavi-di-diffie-hellman.html"><span class="tree-item-title">Scambio di chiavi di Diffie-Hellman</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/secondo-requisito-diffie-hellman.html"><span class="tree-item-title">Secondo requisito Diffie-Hellman</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/struttura-rsa.html"><span class="tree-item-title">Struttura RSA</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="02-cifrari-asimmetrici/terzo-requisito-diffie-hellman.html"><span class="tree-item-title">Terzo requisito Diffie-Hellman</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">03 Network security e software security</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/application-level-gateway.html"><span class="tree-item-title">Application-Level Gateway</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/caso-di-studio-1.html"><span class="tree-item-title">Caso di studio 1</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/caso-di-studio-2.html"><span class="tree-item-title">Caso di studio 2</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/caso-di-studio-3.html"><span class="tree-item-title">Caso di studio 3</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/come-scrivere-shellcode.html"><span class="tree-item-title">Come scrivere shellcode</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/contromisure.html"><span class="tree-item-title">Contromisure</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/dos.html"><span class="tree-item-title">DoS</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/dual-homed-host.html"><span class="tree-item-title">Dual homed host</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/firewall.html"><span class="tree-item-title">Firewall</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/gestione-del-rischio-in-ambito-di-sicurezza-informatica.html"><span class="tree-item-title">Gestione del rischio in ambito di sicurezza informatica</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/injection.html"><span class="tree-item-title">Injection</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/ipsec-e-vpn.html"><span class="tree-item-title">IPsec e VPN</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/logging.html"><span class="tree-item-title">Logging</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/meccanismi-di-firewalling.html"><span class="tree-item-title">Meccanismi di firewalling</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/memory-corruption.html"><span class="tree-item-title">Memory corruption</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/memory-corruption-con-buffer-overflow-dello-stack.html"><span class="tree-item-title">Memory corruption con buffer overflow dello stack</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/owasp.html"><span class="tree-item-title">OWASP</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/packet-filtering.html"><span class="tree-item-title">Packet filtering</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/proxy-service.html"><span class="tree-item-title">Proxy service</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/screened-host.html"><span class="tree-item-title">Screened host</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/screened-subnet.html"><span class="tree-item-title">Screened subnet</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/screening-router.html"><span class="tree-item-title">Screening router</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/sicurezza-delle-reti-e-dei-software-start-point.html"><span class="tree-item-title">Sicurezza delle reti e dei software - Start point</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/sniffing.html"><span class="tree-item-title">Sniffing</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="03-network-security-e-software-security/spoofing.html"><span class="tree-item-title">Spoofing</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">Esami vecchi</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="esami-vecchi/esame-luglio-2016.html"><span class="tree-item-title">Esame luglio 2016</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="esami-vecchi/esame-settembre-2016.html"><span class="tree-item-title">Esame settembre 2016</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div></div><div class="document-container show"><div class="markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-properties" tabindex="-1" style="tab-size:4"><style id="MJX-CHTML-styles">mjx-c.mjx-c1D463.TEX-I::before{padding:.443em .485em .011em 0;content:"v"}mjx-c.mjx-c210E.TEX-I::before{padding:.694em .576em .011em 0;content:"h"}mjx-c.mjx-c1D44A.TEX-I::before{padding:.683em 1.048em .022em 0;content:"W"}mjx-c.mjx-c221E::before{padding:.442em 1em .011em 0;content:"∞"}mjx-c.mjx-cAC::before{padding:.356em .667em 0 0;content:"¬"}mjx-c.mjx-cB1::before{padding:.666em .778em 0 0;content:"±"}mjx-c.mjx-c2203::before{padding:.694em .556em 0 0;content:"∃"}mjx-c.mjx-c1D6FC.TEX-I::before{padding:.442em .64em .011em 0;content:"α"}mjx-c.mjx-c1D719.TEX-I::before{padding:.694em .596em .205em 0;content:"ϕ"}mjx-c.mjx-c3F::before{padding:.705em .472em 0 0;content:"?"}mjx-c.mjx-c3A::before{padding:.43em .278em 0 0;content:":"}mjx-mover{display:inline-block;text-align:left}mjx-mover:not([limits=false]){padding-top:.1em}mjx-mover:not([limits=false])>*{display:block;text-align:left}mjx-c.mjx-c5E::before{padding:.694em .5em 0 0;content:"^"}mjx-c.mjx-c1D45E.TEX-I::before{padding:.442em .46em .194em 0;content:"q"}mjx-c.mjx-c2192::before{padding:.511em 1em .011em 0;content:"→"}mjx-msqrt{display:inline-block;text-align:left}mjx-root{display:inline-block;white-space:nowrap}mjx-surd{display:inline-block;vertical-align:top}mjx-sqrt{display:inline-block;padding-top:.07em}mjx-sqrt>mjx-box{border-top:.07em solid}mjx-sqrt.mjx-tall>mjx-box{padding-left:.3em;margin-left:-.3em}mjx-c.mjx-c221A::before{padding:.8em .853em .2em 0;content:"√"}mjx-c.mjx-c1D460.TEX-I::before{padding:.442em .469em .01em 0;content:"s"}mjx-c.mjx-c2264::before{padding:.636em .778em .138em 0;content:"≤"}mjx-c.mjx-c1D44C.TEX-I::before{padding:.683em .763em 0 0;content:"Y"}mjx-c.mjx-c221A.TEX-S2::before{padding:1.15em 1.02em .65em 0;content:"√"}mjx-c.mjx-c25::before{padding:.75em .833em .056em 0;content:"%"}mjx-mrow{display:inline-block;text-align:left}mjx-mtable{display:inline-block;text-align:center;vertical-align:.25em;position:relative;box-sizing:border-box;border-spacing:0px;border-collapse:collapse}mjx-mstyle[size="s"] mjx-mtable{vertical-align:.354em}mjx-labels{position:absolute;left:0;top:0}mjx-table{display:inline-block;vertical-align:-.5ex;box-sizing:border-box}mjx-table>mjx-itable{vertical-align:middle;text-align:left;box-sizing:border-box}mjx-labels>mjx-itable{position:absolute;top:0}mjx-mtable[justify=left]{text-align:left}mjx-mtable[justify=right]{text-align:right}mjx-mtable[justify=left][side=left]{padding-right:0!important}mjx-mtable[justify=left][side=right]{padding-left:0!important}mjx-mtable[justify=right][side=left]{padding-right:0!important}mjx-mtable[justify=right][side=right]{padding-left:0!important}mjx-mtable[align]{vertical-align:baseline}mjx-mtable[align=top]>mjx-table{vertical-align:top}mjx-mtable[align=bottom]>mjx-table{vertical-align:bottom}mjx-mtable[side=right] mjx-labels{min-width:100%}mjx-mtr{display:table-row;text-align:left}mjx-mtr[rowalign=top]>mjx-mtd{vertical-align:top}mjx-mtr[rowalign=center]>mjx-mtd{vertical-align:middle}mjx-mtr[rowalign=bottom]>mjx-mtd{vertical-align:bottom}mjx-mtr[rowalign=baseline]>mjx-mtd{vertical-align:baseline}mjx-mtr[rowalign=axis]>mjx-mtd{vertical-align:.25em}mjx-mtd{display:table-cell;text-align:center;padding:.215em .4em}mjx-mtd:first-child{padding-left:0}mjx-mtd:last-child{padding-right:0}mjx-mtable>*>mjx-itable>:first-child>mjx-mtd{padding-top:0}mjx-mtable>*>mjx-itable>:last-child>mjx-mtd{padding-bottom:0}mjx-tstrut{display:inline-block;height:1em;vertical-align:-.25em}mjx-labels[align=left]>mjx-mtr>mjx-mtd{text-align:left}mjx-labels[align=right]>mjx-mtr>mjx-mtd{text-align:right}mjx-mtd[extra]{padding:0}mjx-mtd[rowalign=top]{vertical-align:top}mjx-mtd[rowalign=center]{vertical-align:middle}mjx-mtd[rowalign=bottom]{vertical-align:bottom}mjx-mtd[rowalign=baseline]{vertical-align:baseline}mjx-mtd[rowalign=axis]{vertical-align:.25em}mjx-mtext{display:inline-block;text-align:left}mjx-munder{display:inline-block;text-align:left}mjx-over{text-align:left}mjx-munder:not([limits=false]){display:inline-table}mjx-munder>mjx-row{text-align:left}mjx-under{padding-bottom:.1em}mjx-stretchy-h.mjx-c23DF mjx-beg mjx-c::before{content:"";padding:.32em 0 .2em}mjx-stretchy-h.mjx-c23DF mjx-ext mjx-c::before{content:"";padding:.32em 0 .2em}mjx-stretchy-h.mjx-c23DF mjx-end mjx-c::before{content:"";padding:.32em 0 .2em}mjx-stretchy-h.mjx-c23DF mjx-mid mjx-c::before{content:"";padding:.32em 0 .2em}mjx-stretchy-h.mjx-c23DF>mjx-ext{width:50%}mjx-c.mjx-c1D448.TEX-I::before{padding:.683em .767em .022em 0;content:"U"}mjx-c.mjx-c1D442.TEX-I::before{padding:.704em .763em .022em 0;content:"O"}mjx-c.mjx-c1D43B.TEX-I::before{padding:.683em .888em 0 0;content:"H"}mjx-c.mjx-c7C::before{padding:.75em .278em .249em 0;content:"|"}mjx-c.mjx-c2033::before{padding:.56em .55em 0 0;content:"′′"}mjx-c.mjx-c7B.TEX-S3::before{padding:1.45em .75em .949em 0;content:"{"}mjx-c.mjx-cA0::before{padding:0 .25em 0 0;content:" "}mjx-c.mjx-c1D459.TEX-I::before{padding:.694em .298em .011em 0;content:"l"}mjx-c.mjx-c1D461.TEX-I::before{padding:.626em .361em .011em 0;content:"t"}mjx-c.mjx-c6A::before{padding:.669em .306em .205em 0;content:"j"}mjx-c.mjx-c20::before{padding:0 .25em 0 0;content:" "}mjx-c.mjx-c76::before{padding:.431em .528em .011em 0;content:"v"}mjx-c.mjx-c6C::before{padding:.694em .278em 0 0;content:"l"}mjx-c.mjx-c74::before{padding:.615em .389em .01em 0;content:"t"}mjx-c.mjx-c65::before{padding:.448em .444em .011em 0;content:"e"}mjx-c.mjx-c1D449.TEX-I::before{padding:.683em .769em .022em 0;content:"V"}mjx-mfrac{display:inline-block;text-align:left}mjx-frac{display:inline-block;vertical-align:.17em;padding:0 .22em}mjx-frac[type="d"]{vertical-align:.04em}mjx-frac[delims]{padding:0 .1em}mjx-frac[atop]{padding:0 .12em}mjx-frac[atop][delims]{padding:0}mjx-dtable{display:inline-table;width:100%}mjx-dtable>*{font-size:2000%}mjx-dbox{display:block;font-size:5%}mjx-num{display:block;text-align:center}mjx-den{display:block;text-align:center}mjx-mfrac[bevelled]>mjx-num{display:inline-block}mjx-mfrac[bevelled]>mjx-den{display:inline-block}mjx-den[align=right],mjx-num[align=right]{text-align:right}mjx-den[align=left],mjx-num[align=left]{text-align:left}mjx-nstrut{display:inline-block;height:.054em;width:0;vertical-align:-.054em}mjx-nstrut[type="d"]{height:.217em;vertical-align:-.217em}mjx-dstrut{display:inline-block;height:.505em;width:0}mjx-dstrut[type="d"]{height:.726em}mjx-line{display:block;box-sizing:border-box;min-height:1px;height:.06em;border-top:.06em solid;margin:.06em -.1em;overflow:hidden}mjx-line[type="d"]{margin:.18em -.1em}mjx-c.mjx-c3E::before{padding:.54em .778em .04em 0;content:">"}mjx-c.mjx-c1D44B.TEX-I::before{padding:.683em .852em 0 0;content:"X"}mjx-c.mjx-c7B::before{padding:.75em .5em .25em 0;content:"{"}mjx-c.mjx-c7D::before{padding:.75em .5em .25em 0;content:"}"}mjx-c.mjx-cD7::before{padding:.491em .778em 0 0;content:"×"}mjx-c.mjx-c1D451.TEX-I::before{padding:.694em .52em .01em 0;content:"d"}mjx-c.mjx-c1D452.TEX-I::before{padding:.442em .466em .011em 0;content:"e"}mjx-c.mjx-c2032::before{padding:.56em .275em 0 0;content:"′"}mjx-c.mjx-c1D441.TEX-I::before{padding:.683em .888em 0 0;content:"N"}mjx-c.mjx-c1D446.TEX-I::before{padding:.705em .645em .022em 0;content:"S"}mjx-c.mjx-c1D70B.TEX-I::before{padding:.431em .57em .011em 0;content:"π"}mjx-c.mjx-c1D70C.TEX-I::before{padding:.442em .517em .216em 0;content:"ρ"}mjx-c.mjx-c2208::before{padding:.54em .667em .04em 0;content:"∈"}mjx-c.mjx-c2F::before{padding:.75em .5em .25em 0;content:"/"}mjx-c.mjx-c2260::before{padding:.716em .778em .215em 0;content:"≠"}mjx-c.mjx-c1D467.TEX-I::before{padding:.442em .465em .011em 0;content:"z"}mjx-c.mjx-c2261::before{padding:.464em .778em 0 0;content:"≡"}mjx-c.mjx-c1D437.TEX-I::before{padding:.683em .828em 0 0;content:"D"}mjx-c.mjx-c1D43C.TEX-I::before{padding:.683em .504em 0 0;content:"I"}mjx-munderover{display:inline-block;text-align:left}mjx-munderover:not([limits=false]){padding-top:.1em}mjx-munderover:not([limits=false])>*{display:block}mjx-msubsup{display:inline-block;text-align:left}mjx-script{display:inline-block;padding-right:.05em;padding-left:.033em}mjx-script>mjx-spacer{display:block}mjx-c.mjx-c21::before{padding:.716em .278em 0 0;content:"!"}mjx-c.mjx-c2211.TEX-S1::before{padding:.75em 1.056em .25em 0;content:"∑"}mjx-c.mjx-c39::before{padding:.666em .5em .022em 0;content:"9"}mjx-c.mjx-c1D43F.TEX-I::before{padding:.683em .681em 0 0;content:"L"}mjx-c.mjx-c1D447.TEX-I::before{padding:.677em .704em 0 0;content:"T"}mjx-c.mjx-c1D444.TEX-I::before{padding:.704em .791em .194em 0;content:"Q"}mjx-c.mjx-c2248::before{padding:.483em .778em 0 0;content:"≈"}mjx-c.mjx-c1D445.TEX-I::before{padding:.683em .759em .021em 0;content:"R"}mjx-c.mjx-c1D45C.TEX-I::before{padding:.441em .485em .011em 0;content:"o"}mjx-c.mjx-c1D457.TEX-I::before{padding:.661em .412em .204em 0;content:"j"}mjx-c.mjx-c1D454.TEX-I::before{padding:.442em .477em .205em 0;content:"g"}mjx-c.mjx-c1D453.TEX-I::before{padding:.705em .55em .205em 0;content:"f"}mjx-c.mjx-c1D465.TEX-I::before{padding:.442em .572em .011em 0;content:"x"}mjx-c.mjx-c1D45F.TEX-I::before{padding:.442em .451em .011em 0;content:"r"}mjx-c.mjx-c22C5::before{padding:.31em .278em 0 0;content:"⋅"}mjx-c.mjx-c37::before{padding:.676em .5em .022em 0;content:"7"}mjx-c.mjx-c1D466.TEX-I::before{padding:.442em .49em .205em 0;content:"y"}mjx-c.mjx-c1D464.TEX-I::before{padding:.443em .716em .011em 0;content:"w"}mjx-c.mjx-c1D434.TEX-I::before{padding:.716em .75em 0 0;content:"A"}mjx-c.mjx-c1D435.TEX-I::before{padding:.683em .759em 0 0;content:"B"}mjx-msup{display:inline-block;text-align:left}mjx-c.mjx-c1D43A.TEX-I::before{padding:.705em .786em .022em 0;content:"G"}mjx-c.mjx-c1D439.TEX-I::before{padding:.68em .749em 0 0;content:"F"}mjx-c.mjx-c38::before{padding:.666em .5em .022em 0;content:"8"}mjx-c.mjx-c1D44D.TEX-I::before{padding:.683em .723em 0 0;content:"Z"}mjx-c.mjx-c1D44F.TEX-I::before{padding:.694em .429em .011em 0;content:"b"}mjx-c.mjx-c1D443.TEX-I::before{padding:.683em .751em 0 0;content:"P"}mjx-c.mjx-c2C::before{padding:.121em .278em .194em 0;content:","}mjx-c.mjx-c2E::before{padding:.12em .278em 0 0;content:"."}mjx-c.mjx-c1D438.TEX-I::before{padding:.68em .764em 0 0;content:"E"}mjx-c.mjx-c5B::before{padding:.75em .278em .25em 0;content:"["}mjx-c.mjx-c5D::before{padding:.75em .278em .25em 0;content:"]"}mjx-c.mjx-c1D450.TEX-I::before{padding:.442em .433em .011em 0;content:"c"}mjx-c.mjx-c2295::before{padding:.583em .778em .083em 0;content:"⊕"}mjx-c.mjx-c1D45B.TEX-I::before{padding:.442em .6em .011em 0;content:"n"}mjx-c.mjx-c35::before{padding:.666em .5em .022em 0;content:"5"}mjx-c.mjx-c1D43E.TEX-I::before{padding:.683em .889em 0 0;content:"K"}mjx-c.mjx-c30::before{padding:.666em .5em .022em 0;content:"0"}mjx-c.mjx-c31::before{padding:.666em .5em 0 0;content:"1"}mjx-c.mjx-c34::before{padding:.677em .5em 0 0;content:"4"}mjx-container[jax=CHTML]{line-height:0}mjx-container [space="1"]{margin-left:.111em}mjx-container [space="2"]{margin-left:.167em}mjx-container [space="3"]{margin-left:.222em}mjx-container [space="4"]{margin-left:.278em}mjx-container [space="5"]{margin-left:.333em}mjx-container [rspace="1"]{margin-right:.111em}mjx-container [rspace="2"]{margin-right:.167em}mjx-container [rspace="3"]{margin-right:.222em}mjx-container [rspace="4"]{margin-right:.278em}mjx-container [rspace="5"]{margin-right:.333em}mjx-container [size="s"]{font-size:70.7%}mjx-container [size=ss]{font-size:50%}mjx-container [size=Tn]{font-size:60%}mjx-container [size=sm]{font-size:85%}mjx-container [size=lg]{font-size:120%}mjx-container [size=Lg]{font-size:144%}mjx-container [size=LG]{font-size:173%}mjx-container [size=hg]{font-size:207%}mjx-container [size=HG]{font-size:249%}mjx-container [width=full]{width:100%}mjx-box{display:inline-block}mjx-block{display:block}mjx-itable{display:inline-table}mjx-row{display:table-row}mjx-row>*{display:table-cell}mjx-mtext{display:inline-block}mjx-mstyle{display:inline-block}mjx-merror{display:inline-block;color:red;background-color:#ff0}mjx-mphantom{visibility:hidden}mjx-assistive-mml{top:0;left:0;clip:rect(1px,1px,1px,1px);user-select:none;position:absolute!important;padding:1px 0 0!important;border:0!important;display:block!important;width:auto!important;overflow:hidden!important}mjx-assistive-mml[display=block]{width:100%!important}mjx-math{display:inline-block;text-align:left;line-height:0;text-indent:0;font-style:normal;font-weight:400;font-size:100%;letter-spacing:normal;border-collapse:collapse;overflow-wrap:normal;word-spacing:normal;white-space:nowrap;direction:ltr;padding:1px 0}mjx-container[jax=CHTML][display=true]{display:block;text-align:center;margin:1em 0}mjx-container[jax=CHTML][display=true][width=full]{display:flex}mjx-container[jax=CHTML][display=true] mjx-math{padding:0}mjx-container[jax=CHTML][justify=left]{text-align:left}mjx-container[jax=CHTML][justify=right]{text-align:right}mjx-mi{display:inline-block;text-align:left}mjx-c{display:inline-block}mjx-utext{display:inline-block;padding:.75em 0 .2em}mjx-mspace{display:inline-block;text-align:left}mjx-mo{display:inline-block;text-align:left}mjx-stretchy-h{display:inline-table;width:100%}mjx-stretchy-h>*{display:table-cell;width:0}mjx-stretchy-h>*>mjx-c{display:inline-block;transform:scaleX(1)}mjx-stretchy-h>*>mjx-c::before{display:inline-block;width:initial}mjx-stretchy-h>mjx-ext{overflow:clip visible;width:100%}mjx-stretchy-h>mjx-ext>mjx-c::before{transform:scaleX(500)}mjx-stretchy-h>mjx-ext>mjx-c{width:0}mjx-stretchy-h>mjx-beg>mjx-c{margin-right:-.1em}mjx-stretchy-h>mjx-end>mjx-c{margin-left:-.1em}mjx-stretchy-v{display:inline-block}mjx-stretchy-v>*{display:block}mjx-stretchy-v>mjx-beg{height:0}mjx-stretchy-v>mjx-end>mjx-c{display:block}mjx-stretchy-v>*>mjx-c{transform:scaleY(1);transform-origin:left center;overflow:hidden}mjx-stretchy-v>mjx-ext{display:block;height:100%;box-sizing:border-box;border:0 solid transparent;overflow:visible clip}mjx-stretchy-v>mjx-ext>mjx-c::before{width:initial;box-sizing:border-box}mjx-stretchy-v>mjx-ext>mjx-c{transform:scaleY(500) translateY(.075em);overflow:visible}mjx-mark{display:inline-block;height:0}mjx-mn{display:inline-block;text-align:left}mjx-msub{display:inline-block;text-align:left}mjx-texatom{display:inline-block;text-align:left}mjx-c::before{display:block;width:0}.MJX-TEX{font-family:MJXZERO,MJXTEX}.TEX-B{font-family:MJXZERO,MJXTEX-B}.TEX-I{font-family:MJXZERO,MJXTEX-I}.TEX-MI{font-family:MJXZERO,MJXTEX-MI}.TEX-BI{font-family:MJXZERO,MJXTEX-BI}.TEX-S1{font-family:MJXZERO,MJXTEX-S1}.TEX-S2{font-family:MJXZERO,MJXTEX-S2}.TEX-S3{font-family:MJXZERO,MJXTEX-S3}.TEX-S4{font-family:MJXZERO,MJXTEX-S4}.TEX-A{font-family:MJXZERO,MJXTEX-A}.TEX-C{font-family:MJXZERO,MJXTEX-C}.TEX-CB{font-family:MJXZERO,MJXTEX-CB}.TEX-FR{font-family:MJXZERO,MJXTEX-FR}.TEX-FRB{font-family:MJXZERO,MJXTEX-FRB}.TEX-SS{font-family:MJXZERO,MJXTEX-SS}.TEX-SSB{font-family:MJXZERO,MJXTEX-SSB}.TEX-SSI{font-family:MJXZERO,MJXTEX-SSI}.TEX-SC{font-family:MJXZERO,MJXTEX-SC}.TEX-T{font-family:MJXZERO,MJXTEX-T}.TEX-V{font-family:MJXZERO,MJXTEX-V}.TEX-VB{font-family:MJXZERO,MJXTEX-VB}mjx-stretchy-h mjx-c,mjx-stretchy-v mjx-c{font-family:MJXZERO,MJXTEX-S1,MJXTEX-S4,MJXTEX,MJXTEX-A!important}@font-face{font-family:MJXZERO;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff")}@font-face{font-family:MJXTEX;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-B;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-I;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-MI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-BI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff")}@font-face{font-family:MJXTEX-S1;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S2;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S3;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-S4;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-A;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-C;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-CB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-FR;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-FRB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-SS;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-SSB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff")}@font-face{font-family:MJXTEX-SSI;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff")}@font-face{font-family:MJXTEX-SC;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-T;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-V;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff")}@font-face{font-family:MJXTEX-VB;src:url("https://publish.obsidian.md/lib/mathjax/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff")}mjx-c.mjx-c1D440.TEX-I::before{padding:.683em 1.051em 0 0;content:"M"}mjx-c.mjx-c1D44E.TEX-I::before{padding:.441em .529em .01em 0;content:"a"}mjx-c.mjx-c6D::before{padding:.442em .833em 0 0;content:"m"}mjx-c.mjx-c6F::before{padding:.448em .5em .01em 0;content:"o"}mjx-c.mjx-c64::before{padding:.694em .556em .011em 0;content:"d"}mjx-c.mjx-c3C::before{padding:.54em .778em .04em 0;content:"<"}mjx-c.mjx-c3D::before{padding:.583em .778em .082em 0;content:"="}mjx-c.mjx-c32::before{padding:.666em .5em 0 0;content:"2"}mjx-c.mjx-c33::before{padding:.665em .5em .022em 0;content:"3"}mjx-c.mjx-c1D436.TEX-I::before{padding:.705em .76em .022em 0;content:"C"}mjx-c.mjx-c1D456.TEX-I::before{padding:.661em .345em .011em 0;content:"i"}mjx-c.mjx-c1D45D.TEX-I::before{padding:.442em .503em .194em 0;content:"p"}mjx-c.mjx-c2B::before{padding:.583em .778em .082em 0;content:"+"}mjx-c.mjx-c1D458.TEX-I::before{padding:.694em .521em .011em 0;content:"k"}mjx-c.mjx-c28::before{padding:.75em .389em .25em 0;content:"("}mjx-c.mjx-c1D45A.TEX-I::before{padding:.442em .878em .011em 0;content:"m"}mjx-c.mjx-c29::before{padding:.75em .389em .25em 0;content:")"}mjx-c.mjx-c36::before{padding:.666em .5em .022em 0;content:"6"}mjx-c.mjx-c2212::before{padding:.583em .778em .082em 0;content:"−"}</style><div class="markdown-preview-sizer markdown-preview-section" style="min-height:1368px"><div class="markdown-preview-pusher" style="width:1px;height:.1px;margin-bottom:0"></div><div class="mod-header"><div class="inline-title" data-heading="IPsec e VPN" id="IPsec_e_VPN" style="display:block">IPsec e VPN</div></div><div><p>Il protocollo di sicurezza IP, noto anche con il nome di <strong>IPsec</strong>, fornisce sicurezza a livello di rete. IPsec mette in sicurezza i datagrammi IP a livello di rete, tra due qualsiasi entità. Molte organizzazioni utilizzano IPsec per creare delle VPN (<em>Virtual Private Network</em>).<br>Prima di entrare nello specifico di IPsec, facciamo un passo indietro e cerchiamo di capire cosa vuol dire <em>fornire confidenzialità a livello di rete</em>. Con confidenzialità a livello di rete tra un paio di entità (router e router, host e host, router e host), l'entità che invia cifra i payload di tutti i datagrammi che invia all'entità ricevente. Il payload cifrato potrebbe essere un segmento TCP o UPD o un messaggio ICMP, e così via. Tutti i dati inviati da un'entità all'altra verranno nascosti a terzi che potrebbero sniffare il traffico di rete.<br>Oltre alla confidenzialità, un protocollo di sicurezza a livello di rete potrebbe, potenzialmente fornire altri servizi di sicurezza.<br>Potrebbe fornire <strong>autenticazione</strong>, ma anche <strong>integrità dei dati</strong>, in modo che chi riceve i dati possa controllare eventuali manomissioni del pacchetto durante il tragitto verso la destinazione. Potrebbe fornire anche prevenzione per gli attacchi di tipo <em>replay</em>, ovvero un generico ricevente può rilevare eventuali datagrammi duplicati che un attaccante potrebbe inviare.<br>IPsec fornisce meccanismi per tutti questi servizi:</p></div><div><ul><li data-line="0">confidenzialità</li><li data-line="1">autenticazione del mittente</li><li data-line="2">integrità dei dati</li><li data-line="3">prevenzione attacchi di tipo <em>replay</em></li></ul></div><div class="heading-wrapper"><h3 data-heading="IPsec e le Virtual Private Network" class="heading" id="IPsec_e_le_Virtual_Private_Network"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>IPsec e le Virtual Private Network<div class="heading-after">...</div></h3><div class="heading-children"><div><p>Un'organizzazione che si estende su molte regioni spesso desidera avere la propria rete IP, in modo che i suoi host e server possano inviarsi dati in modo sicuro. Per ottenere questo risultato, l'organizzazione potrebbe sviluppare una propria rete fisica a sé stante (quindi router, collegamenti, server DNS, ecc) generando quindi una vera e propria <strong>rete privata</strong> (<em>private network</em>); è chiaro che sviluppare una rete del genere (passando per diverse regioni) ha un costo elevato.<br>Invece di sviluppare e mantenere una rete private, molte organizzazioni oggi creano delle reti private virtuali, ovvero delle VPN, all'interno di Internet stessa. Un semplice esempio di VPN è mostrato nella figura seguente:<br><span alt="Pasted image 20231025165239.png" src="lib\media\pasted-image-20231025165239.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231025165239.png" src="lib\media\pasted-image-20231025165239.png"></span><br>Questa istituzione consiste di headquarters (<em>sede centrale</em>), una filiale (<em>branch office</em>) e di alcuni impiegati (<em>salespersons</em>) che lavorano da un hotel. In figura è mostrato solo un impiegato.<br>In questa VPN, quando due host all'interno della stessa rete (per esempio all'interno della sede centrale o all'interno della filiale) vogliono comunicare, utilizzeranno la versione standard di IP (<em>vanilla, un modo per dire classica</em>). Quando invece due host che si trovano in luoghi geograficamente diversi, per esempio un host di un impiegato in hotel e un host della sede centrale, vogliono comunicare viene utilizzato IPsec.<br>Diciamo che un host nella sede centrale invia un normale pacchetto IP ad un impiegato in un certo hotel nel mondo, il router gateway della sede centrale converte il pacchetto IP <em>vanilla</em> in un pacchetto IPsec e lo inoltra in Internet. Il pacchetto IPsec inoltrato ha un'intestazione IP normalissima, tutti gli altri elementi della rete lo vedranno come un normale pacchetto IP. Come si vede in figura, un pacchetto IPsec include un header IP normale e un header IPsec (e il payload cifrato). Quando il pacchetto giunge all'impiegato, il sistema operativo nel laptop di questo decifra il payload (e fornisce i servizi di sicurezza che abbiamo descritto: integrità dei dati, ecc) e passa il payload decifrato al livello superiore (TCP, UDP).</p></div></div></div><div class="heading-wrapper"><h3 data-heading="I protocolli AH e ESP" class="heading" id="I_protocolli_AH_e_ESP"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>I protocolli AH e ESP<div class="heading-after">...</div></h3><div class="heading-children"><div><p>IPsec è molto complesso, è descritto in una dozzina di documenti RFC molto articolati e complessi.<br>Nella suite di protocolli IPsec ci sono due principali protocolli:</p></div><div><ul><li data-line="0">il protocollo <strong>Authentication Header, AH</strong></li><li data-line="1">il protocollo <strong>Encapsulation Security Payload, ESP</strong><br>Quando un'entità sorgente invia datagrammi messi in sicurezza con IPsec ad un'entità di destinazione lo fa usando AH o ESP. Il protocollo AH fornisce autenticazione del mittente e integrità dei dati ma <em>non fornisce</em> confidenzialità.</li></ul></div></div></div><div class="heading-wrapper"><h3 data-heading="Associazioni di sicurezza (_security association SA_)" class="heading" id="Associazioni_di_sicurezza_(_security_association_SA_)"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Associazioni di sicurezza (<em>security association SA</em>)<div class="heading-after">...</div></h3><div class="heading-children"><div><p>I datagrammi IPsec sono inviati tra due entità di rete, come due host, due router, un host e un router. Prima di inviare un datagramma IPsec dalla sorgente alla destinazione, entrambi gli estremi della comunicazione creano una semplice connessione logica che è <strong>unidirezionale</strong> dalla sorgente alla destinazione. Se entrambe le entità vogliono scambiarsi datagrammi IPsec devono essere create due connessioni unidirezionali da un'estremità all'altra e viceversa. Queste connessioni sono chiamate <strong>associazioni di sicurezza</strong> (<em>security association, SA</em>)<br><span alt="Pasted image 20231025165239.png" src="lib\media\pasted-image-20231025165239.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231025165239.png" src="lib\media\pasted-image-20231025165239.png"></span><br>Consideriamo ancora la figura di prima e diciamo che ci sono:</p></div><div><ul><li data-line="0">una sede centrale</li><li data-line="1">una filiale</li><li data-line="2">e <em>n</em> impiegati in hotel<br>Diciamo che c'è una connessione bidirezionale (quindi due unidirezionali) dalla sede centrale alla filiale e una connessione bidirezionale dalla sede centrale agli impiegati.</li></ul></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="faq" class="callout node-insert-event"><div class="callout-title"><div class="callout-icon"><svg height="16" style="width:16px;max-width:100%"></svg></div><div class="callout-title-inner">In questa VPN quante associazioni di sicurezza (SA) ci sono?</div></div><div class="callout-content"><p>Per rispondere a questa domanda dobbiamo notare che ci sono due SA tra il router della sede centrale e quello della filiale; per ogni computer di un impiegato, ci sono due associazioni di sicurezza tra il router della sede centrale. In totale ci sono: <span class="math math-block is-loaded"><mjx-container class="MathJax" jax="CHTML" display="true"><mjx-math display="true" class="MJX-TEX" style="margin-left:0;margin-right:0"><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align:-.153em"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D446 TEX-I"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D434 TEX-I"></mjx-c></mjx-mi></mjx-texatom></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math></mjx-container></span></p></div></div></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="danger" class="callout node-insert-event"><div class="callout-title"><div class="callout-icon"><svg height="16" style="width:16px;max-width:100%"></svg></div><div class="callout-title-inner">Ricorda che non tutto il traffico inviato in Internet dai router gateway o dai computer saranno messi in sicurezza con IPsec</div></div><div class="callout-content"><p>Per esempio, un host nella sede centrale potrebbe voler accedere ad un server web in internet (non si tratterebbe di una comunicazione con una entità interna all'azienda) l'host potrebbe emettere pacchetti in formato IP vanilla. Un router può emettere entrambi i tipi di pacchetti: IP o IPsec.</p></div></div></div><div><p><span alt="Pasted image 20231025171338.png" src="lib\media\pasted-image-20231025171338.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231025171338.png" src="lib\media\pasted-image-20231025171338.png"></span></p></div><div class="heading-wrapper"><h6 data-heading="Vediamo da più vicino com'è fatta una SA" class="heading" id="Vediamo_da_più_vicino_com'è_fatta_una_SA"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Vediamo da più vicino com'è fatta una SA<div class="heading-after">...</div></h6><div class="heading-children"><div><p>Consideriamo la figura sopra.<br>R1 mantiene delle informazioni di stato sulla SA che includono:</p></div><div><ul><li data-line="0">un identificatore a 32 bit della SA, chiamato <strong>Security Parameter Index (SPI)</strong></li><li data-line="1">l'interfaccia della SA (in questo caso 200.168.1.100) e l'interfaccia di destinazione della SA (in questo caso 193.68.2.23)</li><li data-line="2">il tipo di cifratura da usare (per esempio 3DES con CBC)</li><li data-line="3">la chiave di cifratura</li><li data-line="4">il tipo di controllo di integrità (per esempio HMAC con MD5)</li><li data-line="5">la chiave di autenticazione<br>Quando il router R1 ha bisogno di costruire un datagramma IPsec per inoltrarlo nella SA in figura, il router accede a queste informazioni di stato per determinare come dovrebbe autenticare e cifrare il datagramma. Allo stesso modo il router R2 mantiene le stesse informazioni di stato per questa SA e userà tali informazioni per autenticare e decifrare qualsiasi datagramma IPsec che arriva da essa.<br>Un'entità IPsec (router o host) spesso mantiene informazioni di stato per diverse SA. Per esempio nella figura ce abbiamo visto prima, in cui vi sono <em>n</em> impiegati, la sede centrale deve mantenere <span class="math math-inline is-loaded"><mjx-container class="MathJax" jax="CHTML"><mjx-math class="MJX-TEX"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mo class="mjx-n" space="3"><mjx-c class="mjx-c2B"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="3"><mjx-c class="mjx-c32"></mjx-c></mjx-mn><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D45B TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math></mjx-container></span>SA. Un'entità IPsec salva le informazioni riguardo le SA in un database interno, una struttura dati all'interno del kernel del sistema operativo, chiamato <strong>Security Association Database</strong>.</li></ul></div></div></div><div class="heading-wrapper"><h6 data-heading="Il datagramma IPsec in tunnel mode" class="heading" id="Il_datagramma_IPsec_in_tunnel_mode"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Il datagramma IPsec in tunnel mode<div class="heading-after">...</div></h6><div class="heading-children"><div><p>Avendo fatto una panoramica sulle SA, possiamo adesso descrivere il datagramma IPsec.<br>IPsec ha due formati di pacchetto, uno chiamato <strong>tunnel mode</strong> e l'altro chiamato <strong>transport mode</strong>. La modalità tunnel è più appropriata della modalità trasporto per la creazione di VPN.<br>Partiamo dal descrivere il formato dei pacchetti di IPsec, potrebbe risultare un tantino noioso, ma vedremo tra poco che i datagrammi IPsec assomigliano ad una nota specialità messicana: l'enchilada.<br><span width="300" alt="pngwing.com.png" src="lib\media\pngwing.com.png" class="internal-embed media-embed image-embed is-loaded"><img alt="pngwing.com.png" src="lib\media\pngwing.com.png" style="max-width:100%"></span><br>Di seguito il formato di un pacchetto IPsec.<br>Supponiamo che il router R1 riceve un normale datagramma IPv4 dall'host 172.16.1.17 (all'interno della sede centrale) che è destinato all'host 172.16.2.48 (all'interno della filiale). R1 usa i seguenti passi per convertire il datagramma IPv4 vanilla in un datagramma IPsec:<br><span width="500" alt="Pasted image 20231025175146.png" src="lib\media\pasted-image-20231025175146.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231025175146.png" src="lib\media\pasted-image-20231025175146.png" style="max-width:100%"></span></p></div><div><ul><li data-line="0">Aggiunge all'estremità di destra del datagramma IP originale (che ha include i suoi header originali) un campo <em>ESP trailer</em></li><li data-line="1">Cifra il risultato usando l'algoritmo e la chiave specificato dalla SA</li><li data-line="2">Aggiunge davanti (all'estremità di sinistra) di ciò che è stato cifrato al passo precedente un <em>ESP header</em>; il pacchetto risultante è proprio un'<em>enchilada</em></li><li data-line="3">Crea un authentication MAC sull'intera <em>enchilada</em> usando l'algoritmo e la chiave specificata nella SA</li><li data-line="4">Aggiunge il MAC alla fine dell'<em>enchilada</em> formando un payload</li><li data-line="5">Alla fine crea un nuovo header IP classico (con tutte le informazioni dei campi necessari per IP classico) e lo aggiunge davanti (alla sinistra) del payload<br>Ciò che viene fuori dalla conversione è proprio un datagramma IP classico, seguito da un payload che contiene: un ESP header, il datagramma IP originale cifrato, un trailer ESP e un capo ESP di autenticazione.<br>L'indirizzo originale del datagramma ha 172.16.1.17 come indirizzo sorgente e 172.16.2.48 come indirizzo di destinazione. Poiché il datagramma IPsec include il payload il datagramma IP originale, questi indirizzi sono include (e cifrati) come parte del payload del pacchetto IPsec.</li></ul></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="faq" class="callout node-insert-event"><div class="callout-title"><div class="callout-icon"><svg height="16" style="width:16px;max-width:100%"></svg></div><div class="callout-title-inner">Qual è l'indirizzo IP nell'header creato alla fine e aggiunto davanti al payload IPsec?</div></div><div class="callout-content"><p>Questi sono settati con gli indirizzi delle interfacce di sorgente e destinazione alle due estremità del tunnel, vale a dire 200.168.1.100 e 193.68.2.23. Inoltre il protocollo di questa nuova intestazione IPv4 non è settato con TCP, UDP, o altro, ma con il codice 50 che indica che si tratta di un datagramma IPsec che usa il protocollo IPsec.</p></div></div></div><div><p>Quando viene inviato il datagramma, vengono attraversati diversi router della internet pubblica prima di giungere a R2. Ciascun router processerà il datagramma come se si trattasse di un normale pacchetto IPv4.</p></div></div></div><div class="heading-wrapper"><h6 data-heading="I campi del trailer ESP" class="heading" id="I_campi_del_trailer_ESP"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>I campi del trailer ESP<div class="heading-after">...</div></h6><div class="heading-children"><div><p>Il trailer ESP contiene tre campi:</p></div><div><ul><li data-line="0">padding: una sequenza di byte senza senso che vengono aggiunti al datagramma affinché abbia una dimensione coerente con la dimensione del blocco utilizzato da un qualche algoritmo che sfrutta cifratura a blocchi;</li><li data-line="1">pad-length: indica al destinatario il numero di byte di padding che sono stati aggiunti (e che devono essere rimossi);</li><li data-line="2">next-header indica il tipo di dati contenuti nel payload IP originario (per esempio UDP, TCP, ..)ù</li></ul></div></div></div><div class="heading-wrapper"><h6 data-heading="I campi dell'ESP header" class="heading" id="I_campi_dell'ESP_header"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>I campi dell'ESP header<div class="heading-after">...</div></h6><div class="heading-children"><div><p>Davanti al payload cifrato vi è un header ESP che contiene due campi:</p></div><div><ul><li data-line="0">SPI: che indica all'entità ricevente la SA a cui il datagramma appartiene; in tal modo l'entità destinatario può ricercare nel suo SAD la SA appropriata in cui sono contenute le informazioni di stato per quella SA (come l'algoritmo usato per cifrare/decifrare e le chiavi);</li><li data-line="1">il campo numero di sequenza: è utilizzato per difendersi dagli attacchi di duplicazione (<em>replay-attack</em>).</li></ul></div><div><p>Come abbiamo visto l'entità che invia il datagramma aggiunge un MAC di autenticazione. Come abbiamo detto prima, l'entità mittente calcola un MAC su tutta l'<em>enchilada</em> (formata dall'ESP header, il datagramma IP originale e il trailer ESP, <em>in cui il datagramma e il trailer sono stati cifrati</em>).<br>Ricorda che per calcolare un MAC, il mittente aggiunge una chiave MAC segreta all'<em>enchilada</em> e poi calcola una hash di lunghezza fissa del risultato. Quando R2 riceve il datagramma IPsec, vede che il pacchetto è diretto proprio a sé stesso. R2 allora processa il datagramma. Poiché il campo protocollo (nell'header IP a sinistra) è 50, R2 vede che si tratta di un datagramma IPsec con ESP per processare il datagramma. Prima di vedere come interagisce con l'<em>enchilada</em>, R2 usa SPI per determinare a quale SA il datagramma appartiene. In secondo luogo, calcola il MAC dell'<em>enchilada</em> e verifica ce il MAC sia consistente con il valore nel campo ESP MAC. Se è così, R2 sa per certo che il datagramma arriva da R1 e non è stato manomesso. Fatto ciò, R2 controlla che il numero di sequenza per verificare che il datagramma sia fresco e non duplicato. Dopo di ché R2 decifra il datagramma originale (cifrato con ESP) utilizzando le informazioni salvate nella SA corrispondente. Rimuove il padding in eccesso ed estrae il datagramma originale IP vanilla. Infine, inoltra il datagramma all'ufficio della filiale.</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="note" class="callout node-insert-event"><div class="callout-title"><div class="callout-icon"><svg height="16" style="width:16px;max-width:100%"></svg></div><div class="callout-title-inner">Nota</div></div><div class="callout-content"><p>Quando R1 riceve il datagramma (non sicuro) dall'host mittente della sede centrale. Tale datagramma è destinato a qualche IP di destinazione fuori dalla sede centrale, come fa R1 a sapere se dovrebbe essere inviato con IPsec o no? E in caso in cui debba essere usato IPsec, come fa a sapere quale SA usare (tra tutte quelle possibilmente attive) per tale compito?<br>Il problema si risolve come segue. Insieme al SAD (database di SA), l'entità IPsec ha anche un'altra struttura dati che mantiene altri dati. Questa struttura è chiamata <strong>Security Policy Database, SPD</strong>. L'SPD indica quali datagrammi devono essere convertiti in datagrammi IPsec e per questi, quale SA deve essere usata. Queste informazioni sono mantenute in modo molto simile a le regole dei firewall.<br><span alt="Pasted image 20231025183544.png" src="lib\media\pasted-image-20231025183544.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231025183544.png" src="lib\media\pasted-image-20231025183544.png"></span></p></div></div></div></div></div><div class="heading-wrapper"><h6 data-heading="Il datagramma IPsec in transport mode" class="heading" id="Il_datagramma_IPsec_in_transport_mode"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Il datagramma IPsec in transport mode<div class="heading-after">...</div></h6><div class="heading-children"><div><p>Questa modalità è utilizzato per mettere in sicurezza la comunicazione tra due host fissati. Un tunnel ESP in transport mode connette due host.<br><span alt="Pasted image 20231026160911.png" src="lib\media\pasted-image-20231026160911.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026160911.png" src="lib\media\pasted-image-20231026160911.png"></span><br>In transport mode, ESP è usato per mettere in sicurezza i protocolli del livello superiore a IP, questo vuol dire TCP oppure UDP, ma anche altri come ICMP e altri protocolli validi.<br>Si noti che l'header ESP è inserito dopo l'header IP, ma prima del segmento del livello superiore.<br><span alt="Pasted image 20231026161045.png" src="lib\media\pasted-image-20231026161045.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026161045.png" src="lib\media\pasted-image-20231026161045.png"></span><br>Come vediamo in figura, il payload, fatto dall'header TCP e dei dati, e l'ESP trailer sono cifrati. L'header ESP non è cifrato, altrimenti, il destinatario non sarebbe in grado di trovare la l'SPI e non avrebbe modo di sapere come decifrare il paccehtto, ma è comunque autenticato. Questo vuol dire che un attaccante, per esempio, non può sostituire l'SPI corrente con un altro, o un altro numero di sequenza.</p></div></div></div></div></div><div class="heading-wrapper"><h3 data-heading="AH (_authentication header_)" class="heading" id="AH_(_authentication_header_)"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>AH (<em>authentication header</em>)<div class="heading-after">...</div></h3><div class="heading-children"><div><p>Un datagramma IP è soggetto a manipolazioni arbitrarie da un attaccante. L'header ha il classico checksum, ma questo fornisce solo protezione contro la corruzione. Lo stesso principio è applicato al payload trasportato da un datagrammi, ovvero segmenti a livello di trasporto come TCP e UDP, anche essi sono protetti da checksum, ma anche qui i dati possono essere facilmente manipolati da un attaccante. Alcune situazioni richiedono la verifica che un datagramma IP proviene da chi effettivamente l'ha inviato e i loro payload non sono stati manipolati lungo il transito. Come abbiamo visto tra i servizi offerti da ESP risulta esserci anche l'autenticazione, servizi applicati sfruttando la crittografia. In alcuni casi può essere utile fornire autenticità senza il pesante processo della cifratura. Il protocollo AH fornisce autenticazione agli estremi a integrità dei dati senza l'uso della cifratura.<br>AH fornisce questo servizio attraverso il calcolo di MAC, chiamato <em>intergrity check value (ICV)</em>, su alcune parti dell'intestazione IP e per il payload completo. Il risultato di ICV è piazzato in un header AH e questo è aggiunto al datagramma IP. Il punto esatto in cui viene piazzato l'header AH dipende dalla modalità utilizza: transport mode o tunnel mode.<br>Di seguito i campi di un header IP, nell'immagine sono stati evidenziati (oscurati) i campi che non sono coperti da autenticazione poiché essi cambiano da un hop all'altro. Essi vengono posti a zero prima del calcolo di ICV.<br><span width="500" alt="Pasted image 20231026145728.png" src="lib\media\pasted-image-20231026145728.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026145728.png" src="lib\media\pasted-image-20231026145728.png" style="max-width:100%"></span><br>AH è un protocollo con codice numerico 51.</p></div><div class="heading-wrapper"><h6 data-heading="L'header AH" class="heading" id="L'header_AH"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>L'header AH<div class="heading-after">...</div></h6><div class="heading-children"><div><p>La figura sotto mostra il formato di un header AH, come abbiamo specificato la sua precisa locazione varia in base alla modalità con cui viene utilizzato.<br><span width="500" alt="Pasted image 20231026145907.png" src="lib\media\pasted-image-20231026145907.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026145907.png" src="lib\media\pasted-image-20231026145907.png" style="max-width:100%"></span></p></div><div><ul><li data-line="0">Il campo <em>next header</em> è il numero di protocollo del payload trasportato da AH. Se AH sta proteggendo un datagramma IP che trasporta un segmento TCP allora il numero di protocollo sarà quello di TCP (6). AH potrebbe essere seguito da ESP.</li><li data-line="1">Il campo <em>payload length</em> è confusionari per due ragioni. La prima è che, nonostante il nome, si tratta della lunghezza dell'header AH, non la lunghezza del payload che AH stra proteggendo. Seconda, la lunghezza è espressa con il numero di word di 32 bit meno 2, il motivo è che AH un protocollo concepito per IPv6 in cui la lunghezza dell'header è espressa in questo modo (<em>non sbatterci troppo la testa</em>).</li><li data-line="2">Il campo <em>security parameter index (SPI)</em>, che abbiamo già incontrato nella trattazione di ESP designa la SA cui appartiene il pacchetto AH.</li><li data-line="3">Il campo <em>sequence number</em>, anche questo incontrato in ESP è utile per evitare attacchi di duplicazione.</li><li data-line="4">Il campo <em>authentication data</em>, contiene il risultato del calcolo della ICV.</li></ul></div></div></div></div></div><div class="heading-wrapper"><h3 data-heading="Numeri di sequenza (_sequence numbers_)" class="heading" id="Numeri_di_sequenza_(_sequence_numbers_)"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Numeri di sequenza (<em>sequence numbers</em>)<div class="heading-after">...</div></h3><div class="heading-children"><div><p>Facciamo notare quanto può essere difficile verificare i numeri di sequenza per AH che è un protocollo basato su un livello <em>inaffidabile</em> (IP) che offre un servizio di tipo <em>best-effort</em>, in cui non vi è la garanzia che un datagramma, e di conseguenza un pacchetto AH, non venga smarrito, consegnato fuori ordine, o duplicato.<br>Per cui, per AH, non basta ricordare il numero del prossimo pacchetto che attende e controllare che il pacchetto in arrivo abbia proprio quel numero. Quando un datagramma arriva, il suo numero di sequenza può essere:</p></div><div><ul><li data-line="0">più grande del più alto numero di sequenza ricevuto</li><li data-line="1">più piccolo del più grande numero di sequenza ricevuto, ma non un duplicato di un numero di sequenza di un pacchetto appena ricevuto</li><li data-line="2">uguale ad un numero di sequenza di un pacchetto già ricevuto<br>Idealmente, quello che vorremmo è accogliere i pacchetti che si ritrovano nei primi due casi e rifiutare i datagrammi nel terzo caso. IPsec usa una <em>anti-replay window</em>.<br>Vediamo subito un esempio in cui abbiamo una finestra di lunghezza 4.<br><span width="400" alt="Pasted image 20231026151550.png" src="lib\media\pasted-image-20231026151550.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026151550.png" src="lib\media\pasted-image-20231026151550.png" style="max-width:100%"></span><br>La figura mostra che il più alto numero di sequenza ricevuto ha numero di sequenza 35 e che AH ricorda lo stato dei numeri di sequenza tra 32 e 35 (appunto la lunghezza della finestra: 4).<br>Vediamo che il numero di sequenza 32 e 34 non sono stati ricevuti, mentre i numeri di sequenza 33 e 35 si.<br>Adesso consideriamo come AH usa questa finestra <em>anti-replay</em> per decidere se accettare un datagramma.<br>AH usa tre regole per prendere questa decisione:</li></ul></div><div><ol><li data-line="0">rifiutare qualsiasi datagramma con numero di sequenza alla sinistra della finestra. Quindi anche se il numero di sequenza 30, non è stato ricevuto, nello stato in cui si trova attualmente la finestra, tale pacchetto viene rifiutato.</li><li data-line="1">La seconda regola riguarda i numeri di sequenza che ricadono all'interno della finestra. La regole è di accettare numeri di sequenza nella finestra se il numero di sequenza non è marcato con un 1 (che vuol dire che il pacchetto è già stato ricevuto) e rifiutare tutti gli altri. Pacchetti con numero di sequenza 32 o 34 sono accettati. Quando un pacchetto viene accettato il numero di sequenza corrispondente viene marcato con 1.</li><li data-line="2">La terza regola riguarda i numeri di sequenza alla destra della finestra, ovvero di pacchetti che non sono stati ancora ricevuti, essi vengono accettati e la finestra viene fatta scorrere proprio quando arriva uno di questi. Se arriva per esempio il pacchetto con numero di sequenza 37, la finestra scorre, come si vede di seguito.<br><span width="400" alt="Pasted image 20231026152534.png" src="lib\media\pasted-image-20231026152534.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026152534.png" src="lib\media\pasted-image-20231026152534.png" style="max-width:100%"></span></li></ol></div></div></div><div class="heading-wrapper"><h3 data-heading="Processamento pacchetti AH" class="heading" id="Processamento_pacchetti_AH"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Processamento pacchetti AH<div class="heading-after">...</div></h3><div class="heading-children"><div class="heading-wrapper"><h6 data-heading="Pacchetti AH in uscita" class="heading" id="Pacchetti_AH_in_uscita"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Pacchetti AH in uscita<div class="heading-after">...</div></h6><div class="heading-children"><div><p>Quando un SA per AH viene stabilita, di solito attraverso negoziazioni IKE, l'algoritmo di autenticazione e le chiavi vengono registrate, il contatore per i numeri di sequenza è posto a 0. Quando IPsec determina che ad un pacchetto in uscita dovrebbe essere applicato AH, allora localizza la SA di appartenenza ed esegue il seguente processo:</p></div><div><ol><li data-line="0">Un template per un header AH viene posto tra IP e header del livello superiore.</li><li data-line="1">Il numero di sequenza viene incrementato e salvato nell'header. Se il numero di sequenza ha raggiunto il limite allora viene creata un nuova SA e inizializza il numero di sequenza 0.</li><li data-line="2">Il resto dei campi AH, con l'eccezione del campo ICV, vengono riempiti.</li><li data-line="3">Se richiesto, viene aggiunto del padding all'header AH (per lo stesso motivo discusso in ESP)</li><li data-line="4">I campi mutabili dell'header IP e il campo ICV nell'header vengono posti a zero, l'ICV viene calcolato su tutto il datagramma IP. Se è presente un'opzione di routing alla sorgente (preferenze di routing del mittente) nell'header IP, l'indirizzo di destinazione deve essere settato alla destinazione finale prima di calcolare l'ICV.</li><li data-line="5">I campi mutabili vengono riempiti, e l'ICV viene salvato nell'header AH. Se sono presenti opzioni di routing alla sorgente, il campo <em>destination address</em> deve essere nuovamente settato alla prossima destinazione (<em>e ICV viene ricalcolato</em>).</li><li data-line="6">Il datagramma IP viene piazzato nella coda d'uscita per la trasmissione verso la sua destinazione.</li></ol></div></div></div><div class="heading-wrapper"><h6 data-heading="Pacchetti AH in entrata" class="heading" id="Pacchetti_AH_in_entrata"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Pacchetti AH in entrata<div class="heading-after">...</div></h6><div class="heading-children"><div><p>I pacchetti autenticati con AH potrebbero essere frammentati, ovviamente, prima che AH possa agire su di essi, il datagramma deve essere interamente ricomposto. Dopo di che AH esegue le seguenti operazioni:</p></div><div><ol><li data-line="0">Basandosi sullo SPI nell'header AH e l'indirizzo di destinazione dell'header IP, viene rilevata la SA opportuna. Se non viene rilevata, il pacchetto viene rifiutato.</li><li data-line="1">Se il controllo per il numero di sequenza è abilitato, AH verifica se il numero di sequenza è accettabile (come abbiamo descritto sopra). Se è troppo vecchio o duplicati il datagramma viene rifiutato.</li><li data-line="2">AH copia gli header IP e AH, azzera i campi mutabili dell'header IP e l'ICV di AH.</li><li data-line="3">Tramite l'algoritmo di autenticazione e la chiave specificati nella SA viene calcolato il nuovo ICV per tutto il pacchetto e il risultato viene comparato con quello originale nell'header AH salvato. Se i valori corrispondono, il pacchetto viene accettato, altrimenti no.</li><li data-line="4">L'intestazione AH viene rimossa dal datgramma, i campi originale dell'header IP vengono ripristinati. E il pacchetto viene inserito nella coda di input per essere processato come un normale pacchetto IP.</li></ol></div></div></div><div class="heading-wrapper"><h6 data-heading="AH in transport mode" class="heading" id="AH_in_transport_mode"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>AH in transport mode<div class="heading-after">...</div></h6><div class="heading-children"><div><p>Questa modalità è usata per mettere in sicurezza la comunicazione tra due host fissati. Gli estremi sono specifici host invece che due router o un host e un router.<br><span width="300" alt="Pasted image 20231026154604.png" src="lib\media\pasted-image-20231026154604.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026154604.png" src="lib\media\pasted-image-20231026154604.png" style="max-width:100%"></span><br>Nella modalità trasporto, l'header AH è inserito nel datagramma IP subito dopo l'header IP.<br><span alt="Pasted image 20231026154651.png" src="lib\media\pasted-image-20231026154651.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026154651.png" src="lib\media\pasted-image-20231026154651.png"></span><br>Facciamo notare che vi è una riga che mostra che l'autenticazione va da metà header IP fino al payload (<em>data</em>), questo rappresenta il fatto che non tutti i campi dell'header IP vengono autenticati (quelli mutabili vengono esclusi).</p></div></div></div><div class="heading-wrapper"><h6 data-heading="AH in tunnel mode" class="heading" id="AH_in_tunnel_mode"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>AH in tunnel mode<div class="heading-after">...</div></h6><div class="heading-children"><div><p>La modalità tunnel è usata per connettere due router attraverso un insieme security gateway (router) oppure un host e un security gateways.</p></div><div><div data-callout-metadata="" data-callout-fold="" data-callout="note" class="callout node-insert-event"><div class="callout-title"><div class="callout-icon"><svg height="16" style="width:16px;max-width:100%"></svg></div><div class="callout-title-inner">Security gateway: router compatibile con IPsec e tunnel mode.</div></div></div></div><div><p><span width="500" alt="Pasted image 20231026155553.png" src="lib\media\pasted-image-20231026155553.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026155553.png" src="lib\media\pasted-image-20231026155553.png" style="max-width:100%"></span><br>In figura per esempio, poiché i security gateway devono proteggere i datagrammi tra un paio qualsiasi di host nelle due reti, l'incapsulamento è diverso.<br>Ed è simili a quello che abbiamo tratto per ESP.<br>Ovvero, invece di inserire un header AH tra l'header IP e il protocollo di livello superiore, l'intero datagramma viene incapsulato piazzandogli davanti un header IP e un header AH.<br><span alt="Pasted image 20231026160013.png" src="lib\media\pasted-image-20231026160013.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20231026160013.png" src="lib\media\pasted-image-20231026160013.png"></span><br>Anche qui, l'header IP esterno è autenticato solo per i campi non mutabili, ma notiamo anche che l'header IP interno è completamente autenticato. Quando i pacchetti passeranno nei router intermedi, vedranno un semplice pacchetto IP (con numero di protocollo che indica AH).</p></div></div></div></div></div><div class="heading-wrapper"><h3 data-heading="IKE: Key Management in IPsec" class="heading" id="IKE:_Key_Management_in_IPsec"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>IKE: Key Management in IPsec<div class="heading-after">...</div></h3><div class="heading-children"><div><p>Quando una VPN ha un numero piccolo di end point (due router per esempio), l'amministratore di rete può manualmente configurare le informazioni delle SA nelle SAD dei due estremi della comunicazione. Questa configurazione manuale non è praticabile quando ci sono tante entità da configurare.<br>IPsec utilizza Internet Key Exchange (IKE) protocol.<br>Ogni entità ha un certificato, che include la sua chiave pubblica.</p></div><div><p><strong>Negoziazione delle chiavi</strong>: IKE gestisce la negoziazione delle chiavi per stabilire una sessione di sicurezza condivisa tra i dispositivi che comunicano. Queste chiavi vengono utilizzate per crittografare e decrittografare i dati trasmessi durante la comunicazione.</p></div><div><p><strong>Autenticazione</strong>: IKE verifica l'identità delle parti coinvolte nel processo di negoziazione delle chiavi. Può utilizzare metodi di autenticazione come certificati digitali.</p></div><div><p><strong>Negoziazione dei parametri di sicurezza</strong>: IKE stabilisce i parametri di sicurezza da utilizzare durante la comunicazione IPsec. Questi parametri includono algoritmi di crittografia, metodi di autenticazione, durata delle chiavi e altri dettagli specifici per la SA che devono condividere.</p></div><div><p>Questo procedimento avviene in due fasi.</p></div><div class="heading-wrapper"><h6 data-heading="Fase uno" class="heading" id="Fase_uno"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Fase uno<div class="heading-after">...</div></h6><div class="heading-children"><div><p>I due estremi della comunicazione utilizzano Diffie-Hellman per creare una connessione <strong>IKE SA</strong> (<strong>che è diversa dall'SA discussa nel contesto di IPsec</strong>) tra i router. IKE SA fornisce un canale di autenticazione e cifrato tra i due router. Durante questa fase vengono stabilite le chiavi per la cifratura e l'autenticazione per l'IKE SA. Ciò che viene stabilito è un segreto su cui si basano le chiavi della SA di IPsec. Durante questa fase non sono usate chiavi pubbliche e private RSA.</p></div></div></div><div class="heading-wrapper"><h6 data-heading="Fase due" class="heading" id="Fase_due"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>Fase due<div class="heading-after">...</div></h6><div class="heading-children"><div><p>Nella seconda fase, entrami gli estremi rivelano la propria identità all'altro firmando i loro messaggi. In ogni caso, le identità non sono rivelate ad un <em>passive sniffer</em>, dal momento che sono inviate in un canale IKE SA sicuro. Inoltre durante questa fase, i due estremi negoziano la cifratura IPsec e gli algoritmi di autenticazione che devono essere usati dalle SA di IPsec.</p></div><div><p>Alla fine delle fase due, gli estremi della comunicazione possono cominciare ad usare IPsec.</p></div><div class="mod-footer"></div></div></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder"><div class="graph-view-container"><div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div><canvas id="graph-canvas" width="512px" height="512px"></canvas></div></div></div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#IPsec_e_VPN"><span class="tree-item-title"><p>IPsec e VPN</p></span></a></div><div class="tree-item-children"><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#IPsec_e_le_Virtual_Private_Network"><span class="tree-item-title"><p>IPsec e le Virtual Private Network</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#I_protocolli_AH_e_ESP"><span class="tree-item-title"><p>I protocolli AH e ESP</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Associazioni_di_sicurezza_(_security_association_SA_)"><span class="tree-item-title"><p>Associazioni di sicurezza (<em>security association SA</em>)</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Vediamo_da_più_vicino_com'è_fatta_una_SA"><span class="tree-item-title"><p>Vediamo da più vicino com'è fatta una SA</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Il_datagramma_IPsec_in_tunnel_mode"><span class="tree-item-title"><p>Il datagramma IPsec in tunnel mode</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#I_campi_del_trailer_ESP"><span class="tree-item-title"><p>I campi del trailer ESP</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#I_campi_dell'ESP_header"><span class="tree-item-title"><p>I campi dell'ESP header</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Il_datagramma_IPsec_in_transport_mode"><span class="tree-item-title"><p>Il datagramma IPsec in transport mode</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#AH_(_authentication_header_)"><span class="tree-item-title"><p>AH (<em>authentication header</em>)</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#L'header_AH"><span class="tree-item-title"><p>L'header AH</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Numeri_di_sequenza_(_sequence_numbers_)"><span class="tree-item-title"><p>Numeri di sequenza (<em>sequence numbers</em>)</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Processamento_pacchetti_AH"><span class="tree-item-title"><p>Processamento pacchetti AH</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Pacchetti_AH_in_uscita"><span class="tree-item-title"><p>Pacchetti AH in uscita</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Pacchetti_AH_in_entrata"><span class="tree-item-title"><p>Pacchetti AH in entrata</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#AH_in_transport_mode"><span class="tree-item-title"><p>AH in transport mode</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#AH_in_tunnel_mode"><span class="tree-item-title"><p>AH in tunnel mode</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#IKE:_Key_Management_in_IPsec"><span class="tree-item-title"><p>IKE: Key Management in IPsec</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Fase_uno"><span class="tree-item-title"><p>Fase uno</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="6"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#Fase_due"><span class="tree-item-title"><p>Fase due</p></span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div></div></div></body></html>